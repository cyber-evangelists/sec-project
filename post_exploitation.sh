#!/bin/bash

# Define output file path
output_file="post_exploitation.txt"

# Redirect all output to both terminal and file
exec > >(tee -a "$output_file") 2>&1

# Print a banner
echo "Linux Post-Exploitation Script"
echo "-------------------------------"
echo

# Display basic system information
echo "System Information:"
echo "------------------"
echo "Hostname: $(hostname)"
echo "Kernel Version: $(uname -r)"
echo "Distribution: $(lsb_release -d | cut -f 2)"
echo

# Display network information
echo "Network Information:"
echo "--------------------"
echo "IP Address: $(hostname -I)"
echo "Open Ports:"
netstat -tuln | grep LISTEN
echo

# Display user information
echo "User Information:"
echo "-----------------"
echo "Current User: $(whoami)"
echo "Users on the system:"
cat /etc/passwd | cut -d ":" -f 1
echo

# Display running processes
echo "Running Processes:"
echo "-----------------"
ps aux
echo

# Display contents of /etc/resolv.conf
echo "Contents of /etc/resolv.conf:"
echo "------------------------------"
cat /etc/resolv.conf
echo

# Display contents of /etc/sysconfig/network
echo "Contents of /etc/sysconfig/network:"
echo "------------------------------------"
cat /etc/sysconfig/network
echo

# Display contents of /etc/networks
echo "Contents of /etc/networks:"
echo "--------------------------"
cat /etc/networks
echo

# Display iptables rules
echo "iptables Rules:"
echo "---------------"
iptables -L
echo

# Display hostname
echo "Hostname:"
echo "---------"
hostname
echo

# Display DNS domain name
echo "DNS Domain Name:"
echo "----------------"
dnsdomainname
echo

# List open files and sockets
echo "Open Files and Sockets:"
echo "-----------------------"
lsof -i
echo

# List open files and sockets on port 80
echo "Open Files and Sockets on Port 80:"
echo "----------------------------------"
lsof -i :80
echo

# Search for port 80 in /etc/services
echo "Port 80 in /etc/services:"
echo "--------------------------"
grep 80 /etc/services
echo

# Display network connections
echo "Network Connections:"
echo "--------------------"
netstat -antup
echo

# Display network connections with process information
echo "Network Connections with Process Information:"
echo "--------------------------------------------"
netstat -antpx
echo

# Display listening ports with process information
echo "Listening Ports with Process Information:"
echo "----------------------------------------"
netstat -tulpn
echo

# Additional commands
echo "Additional Commands:"
echo "--------------------"
# Add your additional commands here
echo

# Find all files with SUID set
echo "SUID Files:"
echo "-----------"
find / -type f -perm /4000 2>/dev/null
echo

echo "----------------------------------------------------------------------------"
echo "Output saved to ----> post_exploitation.txt within current working directory"
echo "----------------------------------------------------------------------------"