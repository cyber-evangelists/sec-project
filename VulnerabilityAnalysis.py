import subprocess
from tabulate import tabulate

def vulnerabilityScanner():
    ip = input('-> Please Enter IP Address or URL: ')
    command = f"nmap -sV --script=vulners.nse {ip}"
    output = subprocess.run(command, shell=True, capture_output=True, text=True)
    convert_to_table(output.stdout)

def convert_to_table(output):
    lines = output.split('\n')
    table_data = []
    port_info = False

    for line in lines:
        if "PORT      STATE" in line:
            port_info = True
            headers = line.split()
            table_data.append(headers)
        elif port_info and line:
            row = line.split()
            table_data.append(row)
        elif port_info and not line:
            break

    print(tabulate(table_data, headers="firstrow", tablefmt="grid"))

